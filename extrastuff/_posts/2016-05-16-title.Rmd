---
layout: post
title: surrogate variable analysis
date: 2016-05-16 15:09:00
description: accounting for expression heterogeneity in microarray data
---
In any given experiment there are many variables. There are one or more variables
of interest that we would like to understand the consequences of. There are also 
technical variables that differ between samples because of imperfect instrumentation, experimental practice, environmental whims, etc. Finally, there are biological 
variables such as genetic, age, and gender differences. Failing to account for 
these technical and biological sources of variation can lead to faulty conclusions.


In order to reach the correct conclusions, the only option is usually to follow
good experimental design. This includes keeping non-desirable variation to minimum,
balancing the remaining sources of variation between experimental groups, and
accounting for known sources of variation with statistical models. In general, 
unknown sources of variation cannot be accounted for. This is not true for microarrays 
and other high-throughput experiments, where unknown sources of variation can be 
discovered using the data itself.

This data-driven approach doesn't necessarily determine the actual unknown 
variables. Instead, the unknown variables are collectively approximated with a 
set of surrogate variables. As such, the algorithm is called surrogate variable 
analysis (sva).

Let's look at an example of the power of sva. For this example, there are control
and treatment groups. The treatment group has higher expression for a specific 
set of genes (Figure 1 - left). There is also unknown genetic variability 
distributed among both groups which reduces the expression of an overlapping
set of genes (Figure 1 - middle). Using the expression data, sva discovered one
surrogate variable which was regressed out of the expression data (Figure 1 - right).
Through sva, we have essentially eliminated the influence of the obscuring genetic 
variability. Critically, the influence of the treatment under study remains.

<img src="/img/heatmapsv.svg" class="ImageBorder ImageResponsive2">

The simplified example above fails to clarify how effective sva is in the messy
world of real data. In order to do just that, let's examine a lot of real data.
In order to do so, I need to briefly introduce two R packages that I wrote.

The first, <a href="https://github.com/alexvpickering/ccmap" target="blank">ccmap</a>,
finds drugs and drug combinations that are predicted to reverse or mimic gene 
expression signatures. It does this by comparing a query expression signature
to a set of gene expression signatures from cells treated with 1309 different drugs.
The drug signatures that are most similar and disimilar to the query signature
are predicted to, respectively, mimic and reverse the query signature.

To evaluate sva, I used query signatures resulting from samples that were
independantly treated with 10 drugs that were also measured in the `ccmap` data.
These query signatures should be most similar to the ccmap drug signatures for the
same drugs. To evaluate sva, we can simply compare the results using query signatures
with and without the use of sva.

In order to quickly generate a large number of query signatures with and without
the use of sva, I used the second R package that I wanted to introduce, <a href="https://github.com/alexvpickering/crossmeta" target="blank">crossmeta</a>.
