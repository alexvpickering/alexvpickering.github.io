---
layout: post
title: heatmap in ggplot2
date: 2016-06-09 15:09:00
description: attractive heatmap using RColorBrewer and ggplot2
---

Heatmaps are a common tool for visualizing gene expression patterns produced by
high throughput technologies such as microarrays. Here I demonstrate how to 
produce the following heatmap in R using the ggplot2 package.

<div>
    <img src="/img/heatmap.jpeg">

    <div class="col one caption right">
	    A simple, colour-blind friendly heatmap. The colour scheme from RColorBrewer was               developed based on research as to how individuals interpret colour.
    </div>
    
</div>

<br>

To create the above heatmap, we first generate some example expression data:


```r
# random matrix of expression values
y <- matrix(rnorm(10000), nrow = 1000, ncol = 10)

# columns correspond to samples (5 control and 5 test)
colnames(y) <- paste(rep(c("ctrl", "test"), each = 5), 1:5)

# make the first 300 genes higher in the test group
y[1:300, 6:10] <- y[1:300, 6:10] + 2

# add some expression heterogeneity
y[200:400, c(2, 3, 5, 10)] <- y[200:400, c(2, 3, 5, 10)] - 2
```

To plot the data, we first `melt` it and then plot it using ggplot2:


```r
library(ggplot2)
library(reshape2)
library(RColorBrewer)

ym <- melt(y, varnames = c("gene", "sample"))

# get colours from a red-yellow-blue palette
cols <- colorRampPalette(rev(brewer.pal(11, "RdYlBu")))(100)

ggplot(ym, aes(y = gene, x = sample, fill = value)) +
    geom_raster() + 
    scale_fill_gradientn(name = "", colours = cols, limits = c(-6, 6)) + 
    theme_minimal(base_size = 12) + 
    scale_y_discrete(breaks = NULL) +
    xlab("") + ylab("") +
    theme(axis.text.x = element_text(angle = 45, size = 12))
```
